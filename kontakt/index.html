<script>
  document.getElementById('y').textContent = new Date().getFullYear();

  (function(){
    const params = new URLSearchParams(location.search);
    const p = (params.get('p') || '').trim();       // Produkt/Variante
    const size = (params.get('size') || '').trim(); // optional
    const note = (params.get('note') || '').trim(); // optional

    const contextBox = document.getElementById('contextBox');
    const contextText = document.getElementById('contextText');

    const btnMail = document.getElementById('btnMail');
    const btnWA = document.getElementById('btnWA');

    const productLine = [p, size].filter(Boolean).join(' – ');

    if(productLine){
      contextBox.style.display = '';
      contextText.textContent = productLine;

      // Wenn Produkt-Kontext da ist: WhatsApp wird Primary, Mail Secondary
      btnWA.classList.add('primary');
      btnMail.classList.remove('primary');
    } else {
      // Ohne Kontext: Mail bleibt Primary (neutral)
      btnMail.classList.add('primary');
      btnWA.classList.remove('primary');
    }

    const subject = productLine
      ? `Anfrage – ${productLine} – Luderbein`
      : `Anfrage – Luderbein`;

    const bodyLines = [
      'Hi Luderbein,',
      '',
      productLine ? `Ich möchte anfragen: ${productLine}` : 'Ich möchte etwas anfragen:',
      '',
      '- Größe/Format:',
      '- Personalisierung/Text (optional):',
      '- Foto (falls relevant):',
      '- Skizzen/Beispielbilder (sehr willkommen):',
      '- Sonstiges:',
      '',
      note ? `Notiz: ${note}` : '',
      '',
      'Danke!'
    ].filter(line => line !== '');

    const body = bodyLines.join('\n');

    const mailHref =
      `mailto:luderbein_gravur@icloud.com?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;

    const waText = bodyLines.join('\n');
    const waHref =
      `https://wa.me/491725925858?text=${encodeURIComponent(waText)}`;

    btnMail.setAttribute('href', mailHref);
    btnWA.setAttribute('href', waHref);
  })();
</script>
